without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 87774249.47500001, memory usage is 351096997.90000004
--- the wantmem variable after REDUCE is 87774249.47500001, memory usage is 351096997.90000004
--- the wantmem variable after REDUCE in Mib is 368.1518856699904
--- The memory is being used per voxel is 513.7
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 15036260
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 3007252
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 15788073
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 120.39692735671997
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.387 MiB  158.117 MiB           self.parse_arguments()        
   382  289.395 MiB    0.008 MiB           medium = self.get_medium()
   383  360.578 MiB   71.184 MiB           rte_solver = self.get_solver(medium)
   384  578.469 MiB  217.891 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  580.277 MiB    1.809 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  580.277 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells=  774600  Npnts=  751810
    15  -2.443  0.333E-01   751810     2.18  0.137   [Radiance 0.672 micron]
    16  -2.613  0.333E-01   751810     2.18  0.137   [Radiance 0.672 micron]
    17  -2.708  0.333E-01   751810     2.18  0.137   [Radiance 0.672 micron]
    18  -2.770  0.333E-01   751810     2.18  0.136   [Radiance 0.672 micron]
    19  -3.355  0.332E-01   751810     2.18  0.136   [Radiance 0.672 micron]
    20  -3.730  0.332E-01   751810     2.18  0.136   [Radiance 0.672 micron]
    21  -4.084  0.332E-01   751810     2.18  0.136   [Radiance 0.672 micron]
 ! Iterations:     21     Final Criterion:  0.000082   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 226107970.27500004, memory usage is 904431881.1000001
--- the wantmem variable after REDUCE is 226107970.27500004, memory usage is 904431881.1000001
--- the wantmem variable after REDUCE in Mib is 948.3655641563137
--- The memory is being used per voxel is 1323.3000000000002
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 60145040
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 6014504
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 60896853
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 198.5639238357544
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.312 MiB  158.043 MiB           self.parse_arguments()        
   382  289.320 MiB    0.008 MiB           medium = self.get_medium()
   383  413.582 MiB  124.262 MiB           rte_solver = self.get_solver(medium)
   384 1105.637 MiB  692.055 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1107.570 MiB    1.934 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1107.570 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells=  773888  Npnts=  751811
    14  -2.303  0.475E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    15  -2.394  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    16  -2.466  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    17  -2.833  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    18  -2.908  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    19  -3.171  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    20  -3.371  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    21  -3.498  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    22  -3.556  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    23  -3.829  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    24  -4.160  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
 ! Iterations:     24     Final Criterion:  0.000069   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 773428343.8750001, memory usage is 3093713375.5000005
--- the wantmem variable after REDUCE is 773428343.8750001, memory usage is 3093713375.5000005
--- the wantmem variable after REDUCE in Mib is 3243.993596428288
--- The memory is being used per voxel is 4526.500000000001
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 240580160
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 12029008
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 241331973
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 472.6340274810791
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.387 MiB  158.117 MiB           self.parse_arguments()        
   382  289.395 MiB    0.008 MiB           medium = self.get_medium()
   383  359.629 MiB   70.234 MiB           rte_solver = self.get_solver(medium)
   384 3193.355 MiB 2833.727 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 3195.789 MiB    2.434 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 3195.789 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells=  774022  Npnts=  751810
    14  -2.300  0.500E-01   751810    20.56  0.080   [Radiance 0.672 micron]
    15  -2.378  0.501E-01   751810    20.56  0.080   [Radiance 0.672 micron]
    16  -2.440  0.501E-01   751810    20.56  0.080   [Radiance 0.672 micron]
    17  -2.940  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    18  -3.062  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    19  -3.214  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    20  -3.292  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    21  -3.546  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    22  -3.682  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    23  -3.810  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    24  -3.888  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    25  -4.088  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
 ! Iterations:     25     Final Criterion:  0.000082   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2950680819.0750003, memory usage is 11802723276.300001
--- the wantmem variable after REDUCE is 2950680819.0750003, memory usage is 11802723276.300001
--- the wantmem variable after REDUCE in Mib is 12376.05236216955
--- The memory is being used per voxel is 17268.9
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 962320640
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 24058016
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 963072453
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 1716.5974895954132
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  287.531 MiB  156.262 MiB           self.parse_arguments()        
   382  287.539 MiB    0.008 MiB           medium = self.get_medium()
   383  357.785 MiB   70.246 MiB           rte_solver = self.get_solver(medium)
   384 11497.078 MiB 11139.293 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 11499.602 MiB    2.523 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 11499.602 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 119692158.375, memory usage is 478768633.5
--- the wantmem variable after REDUCE is 119692158.375, memory usage is 478768633.5
--- the wantmem variable after REDUCE in Mib is 502.0252986408959
--- The memory is being used per voxel is 700.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 20504000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 4100800
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 21529200
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 120.74408102035522
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.242 MiB  157.973 MiB           self.parse_arguments()        
   382  289.250 MiB    0.008 MiB           medium = self.get_medium()
   383  441.848 MiB  152.598 MiB           rte_solver = self.get_solver(medium)
   384  712.023 MiB  270.176 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  715.070 MiB    3.047 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  715.070 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 308329050.375, memory usage is 1233316201.5
--- the wantmem variable after REDUCE is 308329050.375, memory usage is 1233316201.5
--- the wantmem variable after REDUCE in Mib is 1293.225769304064
--- The memory is being used per voxel is 1804.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 82016000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 8201600
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 83041200
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 255.7239978313446
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.379 MiB  158.105 MiB           self.parse_arguments()        
   382  289.387 MiB    0.008 MiB           medium = self.get_medium()
   383  438.688 MiB  149.301 MiB           rte_solver = self.get_solver(medium)
   384 1414.602 MiB  975.914 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1417.723 MiB    3.121 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1417.723 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells= 1163654  Npnts= 1025197
    23  -2.908  0.110E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.110E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    25  -3.544  0.110E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    26  -3.878  0.109E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    27  -4.095  0.109E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000080   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1054675014.375, memory usage is 4218700057.5
--- the wantmem variable after REDUCE is 1054675014.375, memory usage is 4218700057.5
--- the wantmem variable after REDUCE in Mib is 4423.62763149312
--- The memory is being used per voxel is 6172.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 328064000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 16403200
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 329089200
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 597.3408622741699
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.164 MiB  157.891 MiB           self.parse_arguments()        
   382  289.172 MiB    0.008 MiB           medium = self.get_medium()
   383  441.582 MiB  152.410 MiB           rte_solver = self.get_solver(medium)
   384 4266.754 MiB 3825.172 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 4269.992 MiB    3.238 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 4269.992 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells= 1159338  Npnts= 1025198
    20  -2.611  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    21  -2.694  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    22  -2.782  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    23  -2.988  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    24  -3.041  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    25  -3.313  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    26  -3.659  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    27  -3.871  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    28  -3.956  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    29  -4.106  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
 ! Iterations:     29     Final Criterion:  0.000078   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 4023655662.375, memory usage is 16094622649.5
--- the wantmem variable after REDUCE is 4023655662.375, memory usage is 16094622649.5
--- the wantmem variable after REDUCE in Mib is 16876.43503932211
--- The memory is being used per voxel is 23548.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 1312256000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 32806400
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 1313281200
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2407.678064584732
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.277 MiB  160.008 MiB           self.parse_arguments()        
   382  291.285 MiB    0.008 MiB           medium = self.get_medium()
   383  442.012 MiB  150.727 MiB           rte_solver = self.get_solver(medium)
   384 15592.902 MiB 15150.891 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 15594.801 MiB    1.898 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 15594.801 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 159589544.5, memory usage is 638358178.0
--- the wantmem variable after REDUCE is 159589544.5, memory usage is 638358178.0
--- the wantmem variable after REDUCE in Mib is 669.3670648545279
--- The memory is being used per voxel is 934.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 27338680
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 5467736
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 28705614
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 119.85642981529236
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.199 MiB  157.934 MiB           self.parse_arguments()        
   382  289.199 MiB    0.000 MiB           medium = self.get_medium()
   383  472.730 MiB  183.531 MiB           rte_solver = self.get_solver(medium)
   384  841.371 MiB  368.641 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  844.359 MiB    2.988 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  844.359 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 411105400.5, memory usage is 1644421602.0
--- the wantmem variable after REDUCE is 411105400.5, memory usage is 1644421602.0
--- the wantmem variable after REDUCE in Mib is 1724.3010257387518
--- The memory is being used per voxel is 2406.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 109354720
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 10935472
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 110721654
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 222.11133408546448
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  288.953 MiB  157.684 MiB           self.parse_arguments()        
   382  288.961 MiB    0.008 MiB           medium = self.get_medium()
   383  473.582 MiB  184.621 MiB           rte_solver = self.get_solver(medium)
   384 1814.020 MiB 1340.438 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1816.898 MiB    2.879 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1816.898 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1406233352.5, memory usage is 5624933410.0
--- the wantmem variable after REDUCE is 1406233352.5, memory usage is 5624933410.0
--- the wantmem variable after REDUCE in Mib is 5898.17017532416
--- The memory is being used per voxel is 8230.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 437418880
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 21870944
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 438785814
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 607.3193490505219
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.180 MiB  157.906 MiB           self.parse_arguments()        
   382  289.188 MiB    0.008 MiB           medium = self.get_medium()
   383  473.062 MiB  183.875 MiB           rte_solver = self.get_solver(medium)
   384 5609.625 MiB 5136.562 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 5612.422 MiB    2.797 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 5612.422 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 5364874216.5, memory usage is 21459496866.0
--- the wantmem variable after REDUCE is 5364874216.5, memory usage is 21459496866.0
--- the wantmem variable after REDUCE in Mib is 22501.91338576281
--- The memory is being used per voxel is 31398.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 1749675520
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 43741888
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 1751042454
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2666.373345375061
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.516 MiB  158.246 MiB           self.parse_arguments()        
   382  289.523 MiB    0.008 MiB           medium = self.get_medium()
   383  472.758 MiB  183.234 MiB           rte_solver = self.get_solver(medium)
   384 20710.340 MiB 20237.582 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 20713.312 MiB    2.973 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 20713.312 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 199486930.625, memory usage is 797947722.5
--- the wantmem variable after REDUCE is 199486930.625, memory usage is 797947722.5
--- the wantmem variable after REDUCE in Mib is 836.70883106816
--- The memory is being used per voxel is 1167.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 34173340
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 6834668
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 35882007
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 130.63713145256042
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.363 MiB  160.090 MiB           self.parse_arguments()        
   382  291.371 MiB    0.008 MiB           medium = self.get_medium()
   383  504.367 MiB  212.996 MiB           rte_solver = self.get_solver(medium)
   384  993.715 MiB  489.348 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  995.531 MiB    1.816 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  995.531 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 513881750.625, memory usage is 2055527002.5
--- the wantmem variable after REDUCE is 513881750.625, memory usage is 2055527002.5
--- the wantmem variable after REDUCE in Mib is 2155.37628217344
--- The memory is being used per voxel is 3007.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 136693360
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 13669336
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 138402027
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 217.39247012138367
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.227 MiB  157.953 MiB           self.parse_arguments()        
   382  289.234 MiB    0.008 MiB           medium = self.get_medium()
   383  502.543 MiB  213.309 MiB           rte_solver = self.get_solver(medium)
   384 2197.801 MiB 1695.258 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 2199.449 MiB    1.648 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 2199.449 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1757791690.625, memory usage is 7031166762.5
--- the wantmem variable after REDUCE is 1757791690.625, memory usage is 7031166762.5
--- the wantmem variable after REDUCE in Mib is 7372.7127191552
--- The memory is being used per voxel is 10287.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 546773440
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 27338672
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 548482107
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 615.6405377388
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.277 MiB  131.277 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.016 MiB  157.738 MiB           self.parse_arguments()        
   382  289.023 MiB    0.008 MiB           medium = self.get_medium()
   383  502.793 MiB  213.770 MiB           rte_solver = self.get_solver(medium)
   384 6944.277 MiB 6441.484 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 6945.980 MiB    1.703 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 6945.980 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 6706092770.625, memory usage is 26824371082.5
--- the wantmem variable after REDUCE is 6706092770.625, memory usage is 26824371082.5
--- the wantmem variable after REDUCE in Mib is 28127.391732203516
--- The memory is being used per voxel is 39247.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 2187093760
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 54677344
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 2188802427
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2652.2799804210663
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.129 MiB  159.855 MiB           self.parse_arguments()        
   382  291.137 MiB    0.008 MiB           medium = self.get_medium()
   383  504.293 MiB  213.156 MiB           rte_solver = self.get_solver(medium)
   384 25822.547 MiB 25318.254 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 25824.680 MiB    2.133 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 25824.680 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 239384316.75, memory usage is 957537267.0
--- the wantmem variable after REDUCE is 239384316.75, memory usage is 957537267.0
--- the wantmem variable after REDUCE in Mib is 1004.0505972817919
--- The memory is being used per voxel is 1401.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 41008020
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 8201604
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 43058421
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 119.18854641914368
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.441 MiB  158.168 MiB           self.parse_arguments()        
   382  289.449 MiB    0.008 MiB           medium = self.get_medium()
   383  551.996 MiB  262.547 MiB           rte_solver = self.get_solver(medium)
   384 1141.762 MiB  589.766 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1144.336 MiB    2.574 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1144.336 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 616658100.75, memory usage is 2466632403.0
--- the wantmem variable after REDUCE is 616658100.75, memory usage is 2466632403.0
--- the wantmem variable after REDUCE in Mib is 2586.451538608128
--- The memory is being used per voxel is 3609.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 164032080
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 16403208
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 166082481
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 266.40947365760803
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.270 MiB  158.000 MiB           self.parse_arguments()        
   382  289.277 MiB    0.008 MiB           medium = self.get_medium()
   383  551.953 MiB  262.676 MiB           rte_solver = self.get_solver(medium)
   384 2581.500 MiB 2029.547 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 2583.500 MiB    2.000 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 2583.500 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2109350028.75, memory usage is 8437400115.0
--- the wantmem variable after REDUCE is 2109350028.75, memory usage is 8437400115.0
--- the wantmem variable after REDUCE in Mib is 8847.25526298624
--- The memory is being used per voxel is 12345.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 656128320
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 32806416
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 658178721
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 604.9560997486115
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.406 MiB  158.133 MiB           self.parse_arguments()        
   382  289.414 MiB    0.008 MiB           medium = self.get_medium()
   383  552.273 MiB  262.859 MiB           rte_solver = self.get_solver(medium)
   384 8280.449 MiB 7728.176 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 8296.066 MiB   15.617 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 8294.035 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 8047311324.75, memory usage is 32189245299.0
--- the wantmem variable after REDUCE is 8047311324.75, memory usage is 32189245299.0
--- the wantmem variable after REDUCE in Mib is 33752.87007864422
--- The memory is being used per voxel is 47097.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 2624513280
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 65612832
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 2626563681
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2667.522320508957
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.289 MiB  158.020 MiB           self.parse_arguments()        
   382  289.297 MiB    0.008 MiB           medium = self.get_medium()
   383  552.270 MiB  262.973 MiB           rte_solver = self.get_solver(medium)
   384 30932.414 MiB 30380.145 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 30934.305 MiB    1.891 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 30934.305 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 279281702.875, memory usage is 1117126811.5
--- the wantmem variable after REDUCE is 279281702.875, memory usage is 1117126811.5
--- the wantmem variable after REDUCE in Mib is 1171.392363495424
--- The memory is being used per voxel is 1634.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 47842680
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 9568536
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 50234814
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 119.0111083984375
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.535 MiB  158.266 MiB           self.parse_arguments()        
   382  289.543 MiB    0.008 MiB           medium = self.get_medium()
   383  591.695 MiB  302.152 MiB           rte_solver = self.get_solver(medium)
   384 1293.703 MiB  702.008 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1295.070 MiB    1.367 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1295.070 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 719434450.875, memory usage is 2877737803.5
--- the wantmem variable after REDUCE is 719434450.875, memory usage is 2877737803.5
--- the wantmem variable after REDUCE in Mib is 3017.5267950428156
--- The memory is being used per voxel is 4210.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 191370720
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 19137072
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 193762854
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 217.63589572906494
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.457 MiB  158.184 MiB           self.parse_arguments()        
   382  289.465 MiB    0.008 MiB           medium = self.get_medium()
   383  591.328 MiB  301.863 MiB           rte_solver = self.get_solver(medium)
   384 2976.996 MiB 2385.668 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 2979.051 MiB    2.055 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 2979.051 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2460908366.875, memory usage is 9843633467.5
--- the wantmem variable after REDUCE is 2460908366.875, memory usage is 9843633467.5
--- the wantmem variable after REDUCE in Mib is 10321.79780681728
--- The memory is being used per voxel is 14402.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 765482880
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 38274144
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 767875014
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 605.5911252498627
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.277 MiB  131.277 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  288.863 MiB  157.586 MiB           self.parse_arguments()        
   382  288.871 MiB    0.008 MiB           medium = self.get_medium()
   383  591.152 MiB  302.281 MiB           rte_solver = self.get_solver(medium)
   384 9621.586 MiB 9030.434 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 9623.645 MiB    2.059 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 9623.645 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 9388529878.875, memory usage is 37554119515.5
--- the wantmem variable after REDUCE is 9388529878.875, memory usage is 37554119515.5
--- the wantmem variable after REDUCE in Mib is 39378.34842508492
--- The memory is being used per voxel is 54946.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 3061931520
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 76548288
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 3064323654
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 3603.3542342185974
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.062 MiB  157.793 MiB           self.parse_arguments()        
   382  289.070 MiB    0.008 MiB           medium = self.get_medium()
   383  591.766 MiB  302.695 MiB           rte_solver = self.get_solver(medium)
   384 36049.664 MiB 35457.898 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 36057.648 MiB    7.984 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 36055.633 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 319179089.0, memory usage is 1276716356.0
--- the wantmem variable after REDUCE is 319179089.0, memory usage is 1276716356.0
--- the wantmem variable after REDUCE in Mib is 1338.7341297090559
--- The memory is being used per voxel is 1868.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 54677360
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 10935472
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 57411228
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 119.55158853530884
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.457 MiB  158.188 MiB           self.parse_arguments()        
   382  289.465 MiB    0.008 MiB           medium = self.get_medium()
   383  630.152 MiB  340.688 MiB           rte_solver = self.get_solver(medium)
   384 1441.414 MiB  811.262 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1443.543 MiB    2.129 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1443.543 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 822210801.0, memory usage is 3288843204.0
--- the wantmem variable after REDUCE is 822210801.0, memory usage is 3288843204.0
--- the wantmem variable after REDUCE in Mib is 3448.6020514775037
--- The memory is being used per voxel is 4812.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 218709440
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 21870944
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 221443308
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 214.39899158477783
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.176 MiB  157.906 MiB           self.parse_arguments()        
   382  289.184 MiB    0.008 MiB           medium = self.get_medium()
   383  628.039 MiB  338.855 MiB           rte_solver = self.get_solver(medium)
   384 3360.727 MiB 2732.688 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 3362.105 MiB    1.379 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 3362.105 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2812466705.0, memory usage is 11249866820.0
--- the wantmem variable after REDUCE is 2812466705.0, memory usage is 11249866820.0
--- the wantmem variable after REDUCE in Mib is 11796.34035064832
--- The memory is being used per voxel is 16460.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 874837760
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 43741888
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 877571628
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 607.4413502216339
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  287.270 MiB  155.996 MiB           self.parse_arguments()        
   382  287.277 MiB    0.008 MiB           medium = self.get_medium()
   383  625.770 MiB  338.492 MiB           rte_solver = self.get_solver(medium)
   384 10954.621 MiB 10328.852 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 10956.332 MiB    1.711 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 10956.332 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 10729748433.0, memory usage is 42918993732.0
--- the wantmem variable after REDUCE is 10729748433.0, memory usage is 42918993732.0
--- the wantmem variable after REDUCE in Mib is 45003.82677152562
--- The memory is being used per voxel is 62796.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 3499351040
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 87483776
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 3502084908
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 3695.9865353107452
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.082 MiB  157.809 MiB           self.parse_arguments()        
   382  289.090 MiB    0.008 MiB           medium = self.get_medium()
   383  627.488 MiB  338.398 MiB           rte_solver = self.get_solver(medium)
   384 41158.578 MiB 40531.090 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 41160.668 MiB    2.090 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 41160.668 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 398973861.25, memory usage is 1595895445.0
--- the wantmem variable after REDUCE is 398973861.25, memory usage is 1595895445.0
--- the wantmem variable after REDUCE in Mib is 1673.41766213632
--- The memory is being used per voxel is 2335.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 68346700
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 13669340
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 71764035
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 129.73305797576904
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.277 MiB  158.004 MiB           self.parse_arguments()        
   382  289.285 MiB    0.008 MiB           medium = self.get_medium()
   383  721.344 MiB  432.059 MiB           rte_solver = self.get_solver(medium)
   384 1733.906 MiB 1012.562 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1735.801 MiB    1.895 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1735.801 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1027763501.25, memory usage is 4111054005.0
--- the wantmem variable after REDUCE is 1027763501.25, memory usage is 4111054005.0
--- the wantmem variable after REDUCE in Mib is 4310.75256434688
--- The memory is being used per voxel is 6015.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 273386800
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 27338680
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 276804135
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 220.003436088562
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.188 MiB  159.918 MiB           self.parse_arguments()        
   382  291.195 MiB    0.008 MiB           medium = self.get_medium()
   383  732.281 MiB  441.086 MiB           rte_solver = self.get_solver(medium)
   384 4141.828 MiB 3409.547 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 4143.426 MiB    1.598 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 4143.426 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 3515583381.25, memory usage is 14062333525.0
--- the wantmem variable after REDUCE is 3515583381.25, memory usage is 14062333525.0
--- the wantmem variable after REDUCE in Mib is 14745.4254383104
--- The memory is being used per voxel is 20575.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 1093547200
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 54677360
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 1096964535
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 627.102813243866
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.219 MiB  157.949 MiB           self.parse_arguments()        
   382  289.227 MiB    0.008 MiB           medium = self.get_medium()
   383  721.496 MiB  432.270 MiB           rte_solver = self.get_solver(medium)
   384 13630.281 MiB 12908.785 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 13631.930 MiB    1.648 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 13631.930 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.1
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 13412185541.25, memory usage is 53648742165.0
--- the wantmem variable after REDUCE is 13412185541.25, memory usage is 53648742165.0
--- the wantmem variable after REDUCE in Mib is 56254.78346440703
--- The memory is being used per voxel is 78495.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 4374188800
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 109354720
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 4377606135
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2946.5624845027924
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.297 MiB  158.023 MiB           self.parse_arguments()        
   382  289.305 MiB    0.008 MiB           medium = self.get_medium()
   383  721.184 MiB  431.879 MiB           rte_solver = self.get_solver(medium)
   384 51383.414 MiB 50662.230 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 51386.168 MiB    2.754 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 51386.168 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 87774249.47500001, memory usage is 351096997.90000004
--- the wantmem variable after REDUCE is 87774249.47500001, memory usage is 351096997.90000004
--- the wantmem variable after REDUCE in Mib is 368.1518856699904
--- The memory is being used per voxel is 513.7
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 15036260
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 3007252
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 15788073
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 118.84432482719421
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.336 MiB  158.066 MiB           self.parse_arguments()        
   382  289.344 MiB    0.008 MiB           medium = self.get_medium()
   383  359.688 MiB   70.344 MiB           rte_solver = self.get_solver(medium)
   384  577.578 MiB  217.891 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  579.270 MiB    1.691 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  579.270 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells=  774600  Npnts=  751810
    15  -2.443  0.333E-01   751810     2.18  0.137   [Radiance 0.672 micron]
    16  -2.613  0.333E-01   751810     2.18  0.137   [Radiance 0.672 micron]
    17  -2.708  0.333E-01   751810     2.18  0.137   [Radiance 0.672 micron]
    18  -2.770  0.333E-01   751810     2.18  0.136   [Radiance 0.672 micron]
    19  -3.355  0.332E-01   751810     2.18  0.136   [Radiance 0.672 micron]
    20  -3.730  0.332E-01   751810     2.18  0.136   [Radiance 0.672 micron]
    21  -4.084  0.332E-01   751810     2.18  0.136   [Radiance 0.672 micron]
 ! Iterations:     21     Final Criterion:  0.000082   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 226107970.27500004, memory usage is 904431881.1000001
--- the wantmem variable after REDUCE is 226107970.27500004, memory usage is 904431881.1000001
--- the wantmem variable after REDUCE in Mib is 948.3655641563137
--- The memory is being used per voxel is 1323.3000000000002
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 60145040
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 6014504
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 60896853
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 175.54021859169006
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.129 MiB  157.859 MiB           self.parse_arguments()        
   382  289.137 MiB    0.008 MiB           medium = self.get_medium()
   383  414.906 MiB  125.770 MiB           rte_solver = self.get_solver(medium)
   384 1106.922 MiB  692.016 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1109.941 MiB    3.020 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1109.941 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells=  773888  Npnts=  751811
    14  -2.303  0.475E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    15  -2.394  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    16  -2.466  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    17  -2.833  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    18  -2.908  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    19  -3.171  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    20  -3.371  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    21  -3.498  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    22  -3.556  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    23  -3.829  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    24  -4.160  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
 ! Iterations:     24     Final Criterion:  0.000069   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 773428343.8750001, memory usage is 3093713375.5000005
--- the wantmem variable after REDUCE is 773428343.8750001, memory usage is 3093713375.5000005
--- the wantmem variable after REDUCE in Mib is 3243.993596428288
--- The memory is being used per voxel is 4526.500000000001
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 240580160
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 12029008
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 241331973
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 494.5417437553406
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.480 MiB  160.211 MiB           self.parse_arguments()        
   382  291.488 MiB    0.008 MiB           medium = self.get_medium()
   383  417.715 MiB  126.227 MiB           rte_solver = self.get_solver(medium)
   384 3197.594 MiB 2779.879 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 3200.363 MiB    2.770 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 3200.363 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells=  774022  Npnts=  751810
    14  -2.300  0.500E-01   751810    20.56  0.080   [Radiance 0.672 micron]
    15  -2.378  0.501E-01   751810    20.56  0.080   [Radiance 0.672 micron]
    16  -2.440  0.501E-01   751810    20.56  0.080   [Radiance 0.672 micron]
    17  -2.940  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    18  -3.062  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    19  -3.214  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    20  -3.292  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    21  -3.546  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    22  -3.682  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    23  -3.810  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    24  -3.888  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    25  -4.088  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
 ! Iterations:     25     Final Criterion:  0.000082   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2950680819.0750003, memory usage is 11802723276.300001
--- the wantmem variable after REDUCE is 2950680819.0750003, memory usage is 11802723276.300001
--- the wantmem variable after REDUCE in Mib is 12376.05236216955
--- The memory is being used per voxel is 17268.9
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 962320640
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 24058016
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 963072453
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 1738.7576818466187
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  290.887 MiB  159.617 MiB           self.parse_arguments()        
   382  290.895 MiB    0.008 MiB           medium = self.get_medium()
   383  362.043 MiB   71.148 MiB           rte_solver = self.get_solver(medium)
   384 11501.336 MiB 11139.293 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 11502.930 MiB    1.594 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 11502.930 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 119692158.375, memory usage is 478768633.5
--- the wantmem variable after REDUCE is 119692158.375, memory usage is 478768633.5
--- the wantmem variable after REDUCE in Mib is 502.0252986408959
--- The memory is being used per voxel is 700.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 20504000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 4100800
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 21529200
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 126.20558381080627
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  287.164 MiB  155.895 MiB           self.parse_arguments()        
   382  287.164 MiB    0.000 MiB           medium = self.get_medium()
   383  437.293 MiB  150.129 MiB           rte_solver = self.get_solver(medium)
   384  707.449 MiB  270.156 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  710.441 MiB    2.992 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  710.441 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 308329050.375, memory usage is 1233316201.5
--- the wantmem variable after REDUCE is 308329050.375, memory usage is 1233316201.5
--- the wantmem variable after REDUCE in Mib is 1293.225769304064
--- The memory is being used per voxel is 1804.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 82016000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 8201600
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 83041200
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 223.955087184906
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.277 MiB  131.277 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.402 MiB  158.125 MiB           self.parse_arguments()        
   382  289.410 MiB    0.008 MiB           medium = self.get_medium()
   383  440.125 MiB  150.715 MiB           rte_solver = self.get_solver(medium)
   384 1416.047 MiB  975.922 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1417.488 MiB    1.441 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1417.488 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells= 1163654  Npnts= 1025197
    23  -2.908  0.110E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.110E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    25  -3.544  0.110E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    26  -3.878  0.109E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    27  -4.095  0.109E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000080   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1054675014.375, memory usage is 4218700057.5
--- the wantmem variable after REDUCE is 1054675014.375, memory usage is 4218700057.5
--- the wantmem variable after REDUCE in Mib is 4423.62763149312
--- The memory is being used per voxel is 6172.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 328064000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 16403200
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 329089200
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 611.2555019855499
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  287.289 MiB  156.020 MiB           self.parse_arguments()        
   382  287.297 MiB    0.008 MiB           medium = self.get_medium()
   383  437.027 MiB  149.730 MiB           rte_solver = self.get_solver(medium)
   384 4262.191 MiB 3825.164 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 4265.004 MiB    2.812 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 4265.004 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells= 1159338  Npnts= 1025198
    20  -2.611  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    21  -2.694  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    22  -2.782  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    23  -2.988  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    24  -3.041  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    25  -3.313  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    26  -3.659  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    27  -3.871  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    28  -3.956  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    29  -4.106  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
 ! Iterations:     29     Final Criterion:  0.000078   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 4023655662.375, memory usage is 16094622649.5
--- the wantmem variable after REDUCE is 4023655662.375, memory usage is 16094622649.5
--- the wantmem variable after REDUCE in Mib is 16876.43503932211
--- The memory is being used per voxel is 23548.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 1312256000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 32806400
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 1313281200
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2434.706043958664
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.367 MiB  158.098 MiB           self.parse_arguments()        
   382  289.375 MiB    0.008 MiB           medium = self.get_medium()
   383  439.188 MiB  149.812 MiB           rte_solver = self.get_solver(medium)
   384 15590.078 MiB 15150.891 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 15592.773 MiB    2.695 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 15592.773 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 159589544.5, memory usage is 638358178.0
--- the wantmem variable after REDUCE is 159589544.5, memory usage is 638358178.0
--- the wantmem variable after REDUCE in Mib is 669.3670648545279
--- The memory is being used per voxel is 934.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 27338680
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 5467736
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 28705614
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 130.13867473602295
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  290.809 MiB  159.539 MiB           self.parse_arguments()        
   382  290.816 MiB    0.008 MiB           medium = self.get_medium()
   383  475.133 MiB  184.316 MiB           rte_solver = self.get_solver(medium)
   384  843.773 MiB  368.641 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  846.328 MiB    2.555 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  846.328 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 411105400.5, memory usage is 1644421602.0
--- the wantmem variable after REDUCE is 411105400.5, memory usage is 1644421602.0
--- the wantmem variable after REDUCE in Mib is 1724.3010257387518
--- The memory is being used per voxel is 2406.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 109354720
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 10935472
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 110721654
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 224.26270627975464
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.270 MiB  158.000 MiB           self.parse_arguments()        
   382  289.277 MiB    0.008 MiB           medium = self.get_medium()
   383  475.945 MiB  186.668 MiB           rte_solver = self.get_solver(medium)
   384 1816.371 MiB 1340.426 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1818.461 MiB    2.090 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1818.461 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1406233352.5, memory usage is 5624933410.0
--- the wantmem variable after REDUCE is 1406233352.5, memory usage is 5624933410.0
--- the wantmem variable after REDUCE in Mib is 5898.17017532416
--- The memory is being used per voxel is 8230.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 437418880
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 21870944
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 438785814
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 621.0927226543427
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.074 MiB  159.809 MiB           self.parse_arguments()        
   382  291.082 MiB    0.008 MiB           medium = self.get_medium()
   383  476.887 MiB  185.805 MiB           rte_solver = self.get_solver(medium)
   384 5613.449 MiB 5136.562 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 5615.176 MiB    1.727 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 5615.176 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 5364874216.5, memory usage is 21459496866.0
--- the wantmem variable after REDUCE is 5364874216.5, memory usage is 21459496866.0
--- the wantmem variable after REDUCE in Mib is 22501.91338576281
--- The memory is being used per voxel is 31398.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 1749675520
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 43741888
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 1751042454
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2682.231441259384
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.367 MiB  158.094 MiB           self.parse_arguments()        
   382  289.375 MiB    0.008 MiB           medium = self.get_medium()
   383  474.160 MiB  184.785 MiB           rte_solver = self.get_solver(medium)
   384 20711.754 MiB 20237.594 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 20713.379 MiB    1.625 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 20713.379 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 199486930.625, memory usage is 797947722.5
--- the wantmem variable after REDUCE is 199486930.625, memory usage is 797947722.5
--- the wantmem variable after REDUCE in Mib is 836.70883106816
--- The memory is being used per voxel is 1167.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 34173340
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 6834668
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 35882007
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 118.62985944747925
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.391 MiB  158.117 MiB           self.parse_arguments()        
   382  289.398 MiB    0.008 MiB           medium = self.get_medium()
   383  502.145 MiB  212.746 MiB           rte_solver = self.get_solver(medium)
   384  991.391 MiB  489.246 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  993.336 MiB    1.945 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  993.336 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 513881750.625, memory usage is 2055527002.5
--- the wantmem variable after REDUCE is 513881750.625, memory usage is 2055527002.5
--- the wantmem variable after REDUCE in Mib is 2155.37628217344
--- The memory is being used per voxel is 3007.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 136693360
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 13669336
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 138402027
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 218.15727400779724
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.562 MiB  160.297 MiB           self.parse_arguments()        
   382  291.570 MiB    0.008 MiB           medium = self.get_medium()
   383  504.730 MiB  213.160 MiB           rte_solver = self.get_solver(medium)
   384 2199.988 MiB 1695.258 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 2207.562 MiB    7.574 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 2207.562 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1757791690.625, memory usage is 7031166762.5
--- the wantmem variable after REDUCE is 1757791690.625, memory usage is 7031166762.5
--- the wantmem variable after REDUCE in Mib is 7372.7127191552
--- The memory is being used per voxel is 10287.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 546773440
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 27338672
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 548482107
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 614.8028581142426
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.484 MiB  158.215 MiB           self.parse_arguments()        
   382  289.484 MiB    0.000 MiB           medium = self.get_medium()
   383  502.992 MiB  213.508 MiB           rte_solver = self.get_solver(medium)
   384 6944.457 MiB 6441.465 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 6945.957 MiB    1.500 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 6945.957 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 6706092770.625, memory usage is 26824371082.5
--- the wantmem variable after REDUCE is 6706092770.625, memory usage is 26824371082.5
--- the wantmem variable after REDUCE in Mib is 28127.391732203516
--- The memory is being used per voxel is 39247.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 2187093760
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 54677344
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 2188802427
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2686.6759061813354
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.449 MiB  158.180 MiB           self.parse_arguments()        
   382  289.457 MiB    0.008 MiB           medium = self.get_medium()
   383  502.031 MiB  212.574 MiB           rte_solver = self.get_solver(medium)
   384 25820.344 MiB 25318.312 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 25822.766 MiB    2.422 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 25822.766 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 239384316.75, memory usage is 957537267.0
--- the wantmem variable after REDUCE is 239384316.75, memory usage is 957537267.0
--- the wantmem variable after REDUCE in Mib is 1004.0505972817919
--- The memory is being used per voxel is 1401.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 41008020
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 8201604
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 43058421
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 128.93199682235718
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.016 MiB  159.742 MiB           self.parse_arguments()        
   382  291.023 MiB    0.008 MiB           medium = self.get_medium()
   383  553.609 MiB  262.586 MiB           rte_solver = self.get_solver(medium)
   384 1143.375 MiB  589.766 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1145.055 MiB    1.680 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1145.055 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 616658100.75, memory usage is 2466632403.0
--- the wantmem variable after REDUCE is 616658100.75, memory usage is 2466632403.0
--- the wantmem variable after REDUCE in Mib is 2586.451538608128
--- The memory is being used per voxel is 3609.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 164032080
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 16403208
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 166082481
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 224.97767686843872
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.137 MiB  157.871 MiB           self.parse_arguments()        
   382  289.137 MiB    0.000 MiB           medium = self.get_medium()
   383  551.824 MiB  262.688 MiB           rte_solver = self.get_solver(medium)
   384 2581.371 MiB 2029.547 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 2583.695 MiB    2.324 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 2583.695 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2109350028.75, memory usage is 8437400115.0
--- the wantmem variable after REDUCE is 2109350028.75, memory usage is 8437400115.0
--- the wantmem variable after REDUCE in Mib is 8847.25526298624
--- The memory is being used per voxel is 12345.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 656128320
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 32806416
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 658178721
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 628.8264796733856
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.098 MiB  157.824 MiB           self.parse_arguments()        
   382  289.105 MiB    0.008 MiB           medium = self.get_medium()
   383  552.227 MiB  263.121 MiB           rte_solver = self.get_solver(medium)
   384 8280.250 MiB 7728.023 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 8282.125 MiB    1.875 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 8282.125 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 8047311324.75, memory usage is 32189245299.0
--- the wantmem variable after REDUCE is 8047311324.75, memory usage is 32189245299.0
--- the wantmem variable after REDUCE in Mib is 33752.87007864422
--- The memory is being used per voxel is 47097.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 2624513280
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 65612832
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 2626563681
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 3440.8012561798096
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.520 MiB  158.246 MiB           self.parse_arguments()        
   382  289.527 MiB    0.008 MiB           medium = self.get_medium()
   383  552.555 MiB  263.027 MiB           rte_solver = self.get_solver(medium)
   384 30932.668 MiB 30380.113 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 30934.574 MiB    1.906 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 30934.574 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 279281702.875, memory usage is 1117126811.5
--- the wantmem variable after REDUCE is 279281702.875, memory usage is 1117126811.5
--- the wantmem variable after REDUCE in Mib is 1171.392363495424
--- The memory is being used per voxel is 1634.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 47842680
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 9568536
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 50234814
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 118.9589638710022
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.547 MiB  160.273 MiB           self.parse_arguments()        
   382  291.555 MiB    0.008 MiB           medium = self.get_medium()
   383  593.402 MiB  301.848 MiB           rte_solver = self.get_solver(medium)
   384 1295.410 MiB  702.008 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1297.508 MiB    2.098 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1297.508 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 719434450.875, memory usage is 2877737803.5
--- the wantmem variable after REDUCE is 719434450.875, memory usage is 2877737803.5
--- the wantmem variable after REDUCE in Mib is 3017.5267950428156
--- The memory is being used per voxel is 4210.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 191370720
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 19137072
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 193762854
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 221.6526346206665
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.023 MiB  157.750 MiB           self.parse_arguments()        
   382  289.031 MiB    0.008 MiB           medium = self.get_medium()
   383  590.957 MiB  301.926 MiB           rte_solver = self.get_solver(medium)
   384 2976.574 MiB 2385.617 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 2978.812 MiB    2.238 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 2978.812 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2460908366.875, memory usage is 9843633467.5
--- the wantmem variable after REDUCE is 2460908366.875, memory usage is 9843633467.5
--- the wantmem variable after REDUCE in Mib is 10321.79780681728
--- The memory is being used per voxel is 14402.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 765482880
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 38274144
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 767875014
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 629.2823069095612
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.121 MiB  157.855 MiB           self.parse_arguments()        
   382  289.129 MiB    0.008 MiB           medium = self.get_medium()
   383  591.133 MiB  302.004 MiB           rte_solver = self.get_solver(medium)
   384 9621.574 MiB 9030.441 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 9624.184 MiB    2.609 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 9624.184 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 9388529878.875, memory usage is 37554119515.5
--- the wantmem variable after REDUCE is 9388529878.875, memory usage is 37554119515.5
--- the wantmem variable after REDUCE in Mib is 39378.34842508492
--- The memory is being used per voxel is 54946.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 3061931520
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 76548288
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 3064323654
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2599.4641473293304
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.152 MiB  157.883 MiB           self.parse_arguments()        
   382  289.160 MiB    0.008 MiB           medium = self.get_medium()
   383  591.195 MiB  302.035 MiB           rte_solver = self.get_solver(medium)
   384 36048.969 MiB 35457.773 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 36051.180 MiB    2.211 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 36051.180 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 319179089.0, memory usage is 1276716356.0
--- the wantmem variable after REDUCE is 319179089.0, memory usage is 1276716356.0
--- the wantmem variable after REDUCE in Mib is 1338.7341297090559
--- The memory is being used per voxel is 1868.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 54677360
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 10935472
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 57411228
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 119.1505331993103
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.219 MiB  157.945 MiB           self.parse_arguments()        
   382  289.227 MiB    0.008 MiB           medium = self.get_medium()
   383  627.625 MiB  338.398 MiB           rte_solver = self.get_solver(medium)
   384 1441.391 MiB  813.766 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1443.074 MiB    1.684 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1443.074 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 822210801.0, memory usage is 3288843204.0
--- the wantmem variable after REDUCE is 822210801.0, memory usage is 3288843204.0
--- the wantmem variable after REDUCE in Mib is 3448.6020514775037
--- The memory is being used per voxel is 4812.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 218709440
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 21870944
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 221443308
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 220.5721824169159
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.383 MiB  158.109 MiB           self.parse_arguments()        
   382  289.391 MiB    0.008 MiB           medium = self.get_medium()
   383  628.613 MiB  339.223 MiB           rte_solver = self.get_solver(medium)
   384 3361.297 MiB 2732.684 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 3362.988 MiB    1.691 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 3362.988 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2812466705.0, memory usage is 11249866820.0
--- the wantmem variable after REDUCE is 2812466705.0, memory usage is 11249866820.0
--- the wantmem variable after REDUCE in Mib is 11796.34035064832
--- The memory is being used per voxel is 16460.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 874837760
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 43741888
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 877571628
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 609.6108541488647
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.309 MiB  158.035 MiB           self.parse_arguments()        
   382  289.309 MiB    0.000 MiB           medium = self.get_medium()
   383  628.145 MiB  338.836 MiB           rte_solver = self.get_solver(medium)
   384 10956.930 MiB 10328.785 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 10959.289 MiB    2.359 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 10959.289 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 10729748433.0, memory usage is 42918993732.0
--- the wantmem variable after REDUCE is 10729748433.0, memory usage is 42918993732.0
--- the wantmem variable after REDUCE in Mib is 45003.82677152562
--- The memory is being used per voxel is 62796.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 3499351040
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 87483776
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 3502084908
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2618.32101893425
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.309 MiB  158.039 MiB           self.parse_arguments()        
   382  289.316 MiB    0.008 MiB           medium = self.get_medium()
   383  630.570 MiB  341.254 MiB           rte_solver = self.get_solver(medium)
   384 41159.074 MiB 40528.504 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 41160.996 MiB    1.922 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 41160.996 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 398973861.25, memory usage is 1595895445.0
--- the wantmem variable after REDUCE is 398973861.25, memory usage is 1595895445.0
--- the wantmem variable after REDUCE in Mib is 1673.41766213632
--- The memory is being used per voxel is 2335.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 68346700
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 13669340
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 71764035
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 130.13896489143372
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  287.320 MiB  156.051 MiB           self.parse_arguments()        
   382  287.328 MiB    0.008 MiB           medium = self.get_medium()
   383  719.332 MiB  432.004 MiB           rte_solver = self.get_solver(medium)
   384 1731.789 MiB 1012.457 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1733.867 MiB    2.078 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1733.867 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1027763501.25, memory usage is 4111054005.0
--- the wantmem variable after REDUCE is 1027763501.25, memory usage is 4111054005.0
--- the wantmem variable after REDUCE in Mib is 4310.75256434688
--- The memory is being used per voxel is 6015.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 273386800
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 27338680
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 276804135
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 259.25314569473267
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  287.551 MiB  156.281 MiB           self.parse_arguments()        
   382  287.559 MiB    0.008 MiB           medium = self.get_medium()
   383  718.965 MiB  431.406 MiB           rte_solver = self.get_solver(medium)
   384 4135.211 MiB 3416.246 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 4137.133 MiB    1.922 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 4137.133 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 3515583381.25, memory usage is 14062333525.0
--- the wantmem variable after REDUCE is 3515583381.25, memory usage is 14062333525.0
--- the wantmem variable after REDUCE in Mib is 14745.4254383104
--- The memory is being used per voxel is 20575.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 1093547200
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 54677360
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 1096964535
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 630.1501214504242
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.344 MiB  158.078 MiB           self.parse_arguments()        
   382  289.352 MiB    0.008 MiB           medium = self.get_medium()
   383  730.176 MiB  440.824 MiB           rte_solver = self.get_solver(medium)
   384 13631.078 MiB 12900.902 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 13632.594 MiB    1.516 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 13632.594 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.2
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 13412185541.25, memory usage is 53648742165.0
--- the wantmem variable after REDUCE is 13412185541.25, memory usage is 53648742165.0
--- the wantmem variable after REDUCE in Mib is 56254.78346440703
--- The memory is being used per voxel is 78495.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 4374188800
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 109354720
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 4377606135
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2614.1281955242157
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.438 MiB  158.164 MiB           self.parse_arguments()        
   382  289.445 MiB    0.008 MiB           medium = self.get_medium()
   383  729.785 MiB  440.340 MiB           rte_solver = self.get_solver(medium)
   384 51383.723 MiB 50653.938 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 51385.207 MiB    1.484 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 51385.207 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 87774249.47500001, memory usage is 351096997.90000004
--- the wantmem variable after REDUCE is 87774249.47500001, memory usage is 351096997.90000004
--- the wantmem variable after REDUCE in Mib is 368.1518856699904
--- The memory is being used per voxel is 513.7
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 15036260
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 3007252
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 15788073
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 129.65976738929749
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  287.418 MiB  156.148 MiB           self.parse_arguments()        
   382  287.426 MiB    0.008 MiB           medium = self.get_medium()
   383  413.520 MiB  126.094 MiB           rte_solver = self.get_solver(medium)
   384  588.805 MiB  175.285 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  591.312 MiB    2.508 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  591.312 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells=  774600  Npnts=  751810
    15  -2.443  0.333E-01   751810     2.18  0.137   [Radiance 0.672 micron]
    16  -2.613  0.333E-01   751810     2.18  0.137   [Radiance 0.672 micron]
    17  -2.708  0.333E-01   751810     2.18  0.137   [Radiance 0.672 micron]
    18  -2.770  0.333E-01   751810     2.18  0.136   [Radiance 0.672 micron]
    19  -3.355  0.332E-01   751810     2.18  0.136   [Radiance 0.672 micron]
    20  -3.730  0.332E-01   751810     2.18  0.136   [Radiance 0.672 micron]
    21  -4.084  0.332E-01   751810     2.18  0.136   [Radiance 0.672 micron]
 ! Iterations:     21     Final Criterion:  0.000082   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 226107970.27500004, memory usage is 904431881.1000001
--- the wantmem variable after REDUCE is 226107970.27500004, memory usage is 904431881.1000001
--- the wantmem variable after REDUCE in Mib is 948.3655641563137
--- The memory is being used per voxel is 1323.3000000000002
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 60145040
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 6014504
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 60896853
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 219.81279134750366
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.191 MiB  159.922 MiB           self.parse_arguments()        
   382  291.199 MiB    0.008 MiB           medium = self.get_medium()
   383  417.707 MiB  126.508 MiB           rte_solver = self.get_solver(medium)
   384 1109.766 MiB  692.059 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1113.684 MiB    3.918 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1113.684 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells=  773888  Npnts=  751811
    14  -2.303  0.475E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    15  -2.394  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    16  -2.466  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    17  -2.833  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    18  -2.908  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    19  -3.171  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    20  -3.371  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    21  -3.498  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    22  -3.556  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    23  -3.829  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    24  -4.160  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
 ! Iterations:     24     Final Criterion:  0.000069   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 773428343.8750001, memory usage is 3093713375.5000005
--- the wantmem variable after REDUCE is 773428343.8750001, memory usage is 3093713375.5000005
--- the wantmem variable after REDUCE in Mib is 3243.993596428288
--- The memory is being used per voxel is 4526.500000000001
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 240580160
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 12029008
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 241331973
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 614.5875658988953
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.547 MiB  158.277 MiB           self.parse_arguments()        
   382  289.555 MiB    0.008 MiB           medium = self.get_medium()
   383  359.945 MiB   70.391 MiB           rte_solver = self.get_solver(medium)
   384 3193.672 MiB 2833.727 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 3195.898 MiB    2.227 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 3195.898 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells=  774022  Npnts=  751810
    14  -2.300  0.500E-01   751810    20.56  0.080   [Radiance 0.672 micron]
    15  -2.378  0.501E-01   751810    20.56  0.080   [Radiance 0.672 micron]
    16  -2.440  0.501E-01   751810    20.56  0.080   [Radiance 0.672 micron]
    17  -2.940  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    18  -3.062  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    19  -3.214  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    20  -3.292  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    21  -3.546  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    22  -3.682  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    23  -3.810  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    24  -3.888  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    25  -4.088  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
 ! Iterations:     25     Final Criterion:  0.000082   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2950680819.0750003, memory usage is 11802723276.300001
--- the wantmem variable after REDUCE is 2950680819.0750003, memory usage is 11802723276.300001
--- the wantmem variable after REDUCE in Mib is 12376.05236216955
--- The memory is being used per voxel is 17268.9
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 962320640
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 24058016
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 963072453
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2414.117946624756
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.090 MiB  159.820 MiB           self.parse_arguments()        
   382  291.098 MiB    0.008 MiB           medium = self.get_medium()
   383  362.410 MiB   71.312 MiB           rte_solver = self.get_solver(medium)
   384 11501.703 MiB 11139.293 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 11503.555 MiB    1.852 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 11503.555 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 119692158.375, memory usage is 478768633.5
--- the wantmem variable after REDUCE is 119692158.375, memory usage is 478768633.5
--- the wantmem variable after REDUCE in Mib is 502.0252986408959
--- The memory is being used per voxel is 700.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 20504000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 4100800
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 21529200
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 122.78396534919739
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.441 MiB  158.176 MiB           self.parse_arguments()        
   382  289.449 MiB    0.008 MiB           medium = self.get_medium()
   383  439.699 MiB  150.250 MiB           rte_solver = self.get_solver(medium)
   384  709.871 MiB  270.172 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  711.477 MiB    1.605 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  711.477 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 308329050.375, memory usage is 1233316201.5
--- the wantmem variable after REDUCE is 308329050.375, memory usage is 1233316201.5
--- the wantmem variable after REDUCE in Mib is 1293.225769304064
--- The memory is being used per voxel is 1804.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 82016000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 8201600
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 83041200
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 257.1107985973358
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.488 MiB  158.219 MiB           self.parse_arguments()        
   382  289.496 MiB    0.008 MiB           medium = self.get_medium()
   383  439.062 MiB  149.566 MiB           rte_solver = self.get_solver(medium)
   384 1414.984 MiB  975.922 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1417.281 MiB    2.297 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1417.281 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells= 1163654  Npnts= 1025197
    23  -2.908  0.110E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.110E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    25  -3.544  0.110E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    26  -3.878  0.109E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    27  -4.095  0.109E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000080   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1054675014.375, memory usage is 4218700057.5
--- the wantmem variable after REDUCE is 1054675014.375, memory usage is 4218700057.5
--- the wantmem variable after REDUCE in Mib is 4423.62763149312
--- The memory is being used per voxel is 6172.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 328064000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 16403200
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 329089200
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 836.5729711055756
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.297 MiB  158.023 MiB           self.parse_arguments()        
   382  289.305 MiB    0.008 MiB           medium = self.get_medium()
   383  439.332 MiB  150.027 MiB           rte_solver = self.get_solver(medium)
   384 4264.504 MiB 3825.172 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 4266.633 MiB    2.129 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 4266.633 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells= 1159338  Npnts= 1025198
    20  -2.611  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    21  -2.694  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    22  -2.782  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    23  -2.988  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    24  -3.041  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    25  -3.313  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    26  -3.659  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    27  -3.871  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    28  -3.956  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    29  -4.106  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
 ! Iterations:     29     Final Criterion:  0.000078   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 4023655662.375, memory usage is 16094622649.5
--- the wantmem variable after REDUCE is 4023655662.375, memory usage is 16094622649.5
--- the wantmem variable after REDUCE in Mib is 16876.43503932211
--- The memory is being used per voxel is 23548.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 1312256000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 32806400
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 1313281200
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2405.4707567691803
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.289 MiB  158.023 MiB           self.parse_arguments()        
   382  289.297 MiB    0.008 MiB           medium = self.get_medium()
   383  440.129 MiB  150.832 MiB           rte_solver = self.get_solver(medium)
   384 15591.070 MiB 15150.941 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 15593.051 MiB    1.980 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 15593.051 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 159589544.5, memory usage is 638358178.0
--- the wantmem variable after REDUCE is 159589544.5, memory usage is 638358178.0
--- the wantmem variable after REDUCE in Mib is 669.3670648545279
--- The memory is being used per voxel is 934.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 27338680
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 5467736
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 28705614
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 120.05976128578186
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.270 MiB  158.000 MiB           self.parse_arguments()        
   382  289.270 MiB    0.000 MiB           medium = self.get_medium()
   383  473.672 MiB  184.402 MiB           rte_solver = self.get_solver(medium)
   384  842.312 MiB  368.641 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  844.805 MiB    2.492 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  844.805 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 411105400.5, memory usage is 1644421602.0
--- the wantmem variable after REDUCE is 411105400.5, memory usage is 1644421602.0
--- the wantmem variable after REDUCE in Mib is 1724.3010257387518
--- The memory is being used per voxel is 2406.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 109354720
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 10935472
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 110721654
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 219.2317852973938
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.473 MiB  158.203 MiB           self.parse_arguments()        
   382  289.480 MiB    0.008 MiB           medium = self.get_medium()
   383  474.246 MiB  184.766 MiB           rte_solver = self.get_solver(medium)
   384 1814.684 MiB 1340.438 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1825.793 MiB   11.109 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1825.781 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1406233352.5, memory usage is 5624933410.0
--- the wantmem variable after REDUCE is 1406233352.5, memory usage is 5624933410.0
--- the wantmem variable after REDUCE in Mib is 5898.17017532416
--- The memory is being used per voxel is 8230.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 437418880
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 21870944
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 438785814
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 624.458306312561
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.125 MiB  157.859 MiB           self.parse_arguments()        
   382  289.133 MiB    0.008 MiB           medium = self.get_medium()
   383  473.824 MiB  184.691 MiB           rte_solver = self.get_solver(medium)
   384 5610.387 MiB 5136.562 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 5612.293 MiB    1.906 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 5612.293 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 5364874216.5, memory usage is 21459496866.0
--- the wantmem variable after REDUCE is 5364874216.5, memory usage is 21459496866.0
--- the wantmem variable after REDUCE in Mib is 22501.91338576281
--- The memory is being used per voxel is 31398.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 1749675520
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 43741888
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 1751042454
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2690.709394931793
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.207 MiB  157.934 MiB           self.parse_arguments()        
   382  289.215 MiB    0.008 MiB           medium = self.get_medium()
   383  473.391 MiB  184.176 MiB           rte_solver = self.get_solver(medium)
   384 20710.980 MiB 20237.590 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 20713.945 MiB    2.965 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 20713.945 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 199486930.625, memory usage is 797947722.5
--- the wantmem variable after REDUCE is 199486930.625, memory usage is 797947722.5
--- the wantmem variable after REDUCE in Mib is 836.70883106816
--- The memory is being used per voxel is 1167.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 34173340
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 6834668
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 35882007
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 119.17494797706604
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.457 MiB  158.184 MiB           self.parse_arguments()        
   382  289.465 MiB    0.008 MiB           medium = self.get_medium()
   383  503.047 MiB  213.582 MiB           rte_solver = self.get_solver(medium)
   384  992.391 MiB  489.344 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  994.062 MiB    1.672 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  994.062 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 513881750.625, memory usage is 2055527002.5
--- the wantmem variable after REDUCE is 513881750.625, memory usage is 2055527002.5
--- the wantmem variable after REDUCE in Mib is 2155.37628217344
--- The memory is being used per voxel is 3007.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 136693360
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 13669336
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 138402027
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 215.73963737487793
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.391 MiB  158.121 MiB           self.parse_arguments()        
   382  289.398 MiB    0.008 MiB           medium = self.get_medium()
   383  503.270 MiB  213.871 MiB           rte_solver = self.get_solver(medium)
   384 2198.504 MiB 1695.234 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 2200.234 MiB    1.730 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 2200.234 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1757791690.625, memory usage is 7031166762.5
--- the wantmem variable after REDUCE is 1757791690.625, memory usage is 7031166762.5
--- the wantmem variable after REDUCE in Mib is 7372.7127191552
--- The memory is being used per voxel is 10287.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 546773440
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 27338672
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 548482107
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 609.5722408294678
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.430 MiB  158.156 MiB           self.parse_arguments()        
   382  289.438 MiB    0.008 MiB           medium = self.get_medium()
   383  502.273 MiB  212.836 MiB           rte_solver = self.get_solver(medium)
   384 6943.879 MiB 6441.605 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 6945.477 MiB    1.598 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 6945.477 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 6706092770.625, memory usage is 26824371082.5
--- the wantmem variable after REDUCE is 6706092770.625, memory usage is 26824371082.5
--- the wantmem variable after REDUCE in Mib is 28127.391732203516
--- The memory is being used per voxel is 39247.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 2187093760
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 54677344
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 2188802427
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2700.283434152603
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  292.980 MiB  161.715 MiB           self.parse_arguments()        
   382  292.980 MiB    0.000 MiB           medium = self.get_medium()
   383  506.664 MiB  213.684 MiB           rte_solver = self.get_solver(medium)
   384 25824.938 MiB 25318.273 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 25827.109 MiB    2.172 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 25827.109 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 239384316.75, memory usage is 957537267.0
--- the wantmem variable after REDUCE is 239384316.75, memory usage is 957537267.0
--- the wantmem variable after REDUCE in Mib is 1004.0505972817919
--- The memory is being used per voxel is 1401.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 41008020
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 8201604
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 43058421
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 121.27663993835449
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.336 MiB  158.062 MiB           self.parse_arguments()        
   382  289.344 MiB    0.008 MiB           medium = self.get_medium()
   383  552.223 MiB  262.879 MiB           rte_solver = self.get_solver(medium)
   384 1141.988 MiB  589.766 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1143.953 MiB    1.965 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1143.953 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 616658100.75, memory usage is 2466632403.0
--- the wantmem variable after REDUCE is 616658100.75, memory usage is 2466632403.0
--- the wantmem variable after REDUCE in Mib is 2586.451538608128
--- The memory is being used per voxel is 3609.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 164032080
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 16403208
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 166082481
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 265.7183337211609
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.203 MiB  157.934 MiB           self.parse_arguments()        
   382  289.211 MiB    0.008 MiB           medium = self.get_medium()
   383  552.570 MiB  263.359 MiB           rte_solver = self.get_solver(medium)
   384 2582.117 MiB 2029.547 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 2583.727 MiB    1.609 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 2583.727 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2109350028.75, memory usage is 8437400115.0
--- the wantmem variable after REDUCE is 2109350028.75, memory usage is 8437400115.0
--- the wantmem variable after REDUCE in Mib is 8847.25526298624
--- The memory is being used per voxel is 12345.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 656128320
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 32806416
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 658178721
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 825.0471203327179
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.277 MiB  131.277 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  290.965 MiB  159.688 MiB           self.parse_arguments()        
   382  290.973 MiB    0.008 MiB           medium = self.get_medium()
   383  554.410 MiB  263.438 MiB           rte_solver = self.get_solver(medium)
   384 8282.562 MiB 7728.152 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 8284.117 MiB    1.555 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 8284.117 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 8047311324.75, memory usage is 32189245299.0
--- the wantmem variable after REDUCE is 8047311324.75, memory usage is 32189245299.0
--- the wantmem variable after REDUCE in Mib is 33752.87007864422
--- The memory is being used per voxel is 47097.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 2624513280
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 65612832
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 2626563681
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2587.0441958904266
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.039 MiB  157.766 MiB           self.parse_arguments()        
   382  289.047 MiB    0.008 MiB           medium = self.get_medium()
   383  552.613 MiB  263.566 MiB           rte_solver = self.get_solver(medium)
   384 30932.758 MiB 30380.145 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 30934.441 MiB    1.684 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 30934.441 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 279281702.875, memory usage is 1117126811.5
--- the wantmem variable after REDUCE is 279281702.875, memory usage is 1117126811.5
--- the wantmem variable after REDUCE in Mib is 1171.392363495424
--- The memory is being used per voxel is 1634.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 47842680
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 9568536
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 50234814
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 128.5127568244934
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.199 MiB  157.926 MiB           self.parse_arguments()        
   382  289.207 MiB    0.008 MiB           medium = self.get_medium()
   383  591.230 MiB  302.023 MiB           rte_solver = self.get_solver(medium)
   384 1293.289 MiB  702.059 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1294.977 MiB    1.688 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1294.977 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 719434450.875, memory usage is 2877737803.5
--- the wantmem variable after REDUCE is 719434450.875, memory usage is 2877737803.5
--- the wantmem variable after REDUCE in Mib is 3017.5267950428156
--- The memory is being used per voxel is 4210.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 191370720
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 19137072
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 193762854
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 216.66439509391785
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.277 MiB  131.277 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.516 MiB  160.238 MiB           self.parse_arguments()        
   382  291.523 MiB    0.008 MiB           medium = self.get_medium()
   383  593.273 MiB  301.750 MiB           rte_solver = self.get_solver(medium)
   384 2978.906 MiB 2385.633 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 2980.555 MiB    1.648 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 2980.555 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2460908366.875, memory usage is 9843633467.5
--- the wantmem variable after REDUCE is 2460908366.875, memory usage is 9843633467.5
--- the wantmem variable after REDUCE in Mib is 10321.79780681728
--- The memory is being used per voxel is 14402.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 765482880
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 38274144
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 767875014
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 613.06769323349
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.312 MiB  158.039 MiB           self.parse_arguments()        
   382  289.320 MiB    0.008 MiB           medium = self.get_medium()
   383  592.059 MiB  302.738 MiB           rte_solver = self.get_solver(medium)
   384 9622.480 MiB 9030.422 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 9623.934 MiB    1.453 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 9623.934 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 9388529878.875, memory usage is 37554119515.5
--- the wantmem variable after REDUCE is 9388529878.875, memory usage is 37554119515.5
--- the wantmem variable after REDUCE in Mib is 39378.34842508492
--- The memory is being used per voxel is 54946.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 3061931520
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 76548288
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 3064323654
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2623.954576253891
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.062 MiB  159.797 MiB           self.parse_arguments()        
   382  291.070 MiB    0.008 MiB           medium = self.get_medium()
   383  593.270 MiB  302.199 MiB           rte_solver = self.get_solver(medium)
   384 36051.086 MiB 35457.816 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 36053.133 MiB    2.047 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 36053.133 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 319179089.0, memory usage is 1276716356.0
--- the wantmem variable after REDUCE is 319179089.0, memory usage is 1276716356.0
--- the wantmem variable after REDUCE in Mib is 1338.7341297090559
--- The memory is being used per voxel is 1868.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 54677360
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 10935472
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 57411228
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 120.72120594978333
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.277 MiB  158.004 MiB           self.parse_arguments()        
   382  289.285 MiB    0.008 MiB           medium = self.get_medium()
   383  627.156 MiB  337.871 MiB           rte_solver = self.get_solver(medium)
   384 1440.941 MiB  813.785 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1444.242 MiB    3.301 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1444.242 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 822210801.0, memory usage is 3288843204.0
--- the wantmem variable after REDUCE is 822210801.0, memory usage is 3288843204.0
--- the wantmem variable after REDUCE in Mib is 3448.6020514775037
--- The memory is being used per voxel is 4812.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 218709440
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 21870944
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 221443308
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 222.53150463104248
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.352 MiB  160.078 MiB           self.parse_arguments()        
   382  291.359 MiB    0.008 MiB           medium = self.get_medium()
   383  630.148 MiB  338.789 MiB           rte_solver = self.get_solver(medium)
   384 3362.855 MiB 2732.707 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 3364.547 MiB    1.691 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 3364.547 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2812466705.0, memory usage is 11249866820.0
--- the wantmem variable after REDUCE is 2812466705.0, memory usage is 11249866820.0
--- the wantmem variable after REDUCE in Mib is 11796.34035064832
--- The memory is being used per voxel is 16460.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 874837760
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 43741888
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 877571628
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 620.0676736831665
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.344 MiB  158.074 MiB           self.parse_arguments()        
   382  289.352 MiB    0.008 MiB           medium = self.get_medium()
   383  627.898 MiB  338.547 MiB           rte_solver = self.get_solver(medium)
   384 10956.750 MiB 10328.852 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 10970.449 MiB   13.699 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 10968.457 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 10729748433.0, memory usage is 42918993732.0
--- the wantmem variable after REDUCE is 10729748433.0, memory usage is 42918993732.0
--- the wantmem variable after REDUCE in Mib is 45003.82677152562
--- The memory is being used per voxel is 62796.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 3499351040
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 87483776
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 3502084908
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 3725.885416507721
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.277 MiB  131.277 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.316 MiB  158.039 MiB           self.parse_arguments()        
   382  289.324 MiB    0.008 MiB           medium = self.get_medium()
   383  630.027 MiB  340.703 MiB           rte_solver = self.get_solver(medium)
   384 41158.598 MiB 40528.570 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 41161.062 MiB    2.465 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 41161.062 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 398973861.25, memory usage is 1595895445.0
--- the wantmem variable after REDUCE is 398973861.25, memory usage is 1595895445.0
--- the wantmem variable after REDUCE in Mib is 1673.41766213632
--- The memory is being used per voxel is 2335.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 68346700
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 13669340
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 71764035
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 119.37115049362183
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  294.906 MiB  163.633 MiB           self.parse_arguments()        
   382  294.914 MiB    0.008 MiB           medium = self.get_medium()
   383  727.172 MiB  432.258 MiB           rte_solver = self.get_solver(medium)
   384 1739.789 MiB 1012.617 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1741.746 MiB    1.957 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1741.746 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1027763501.25, memory usage is 4111054005.0
--- the wantmem variable after REDUCE is 1027763501.25, memory usage is 4111054005.0
--- the wantmem variable after REDUCE in Mib is 4310.75256434688
--- The memory is being used per voxel is 6015.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 273386800
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 27338680
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 276804135
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 264.8809461593628
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.293 MiB  158.023 MiB           self.parse_arguments()        
   382  289.301 MiB    0.008 MiB           medium = self.get_medium()
   383  721.727 MiB  432.426 MiB           rte_solver = self.get_solver(medium)
   384 4138.137 MiB 3416.410 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 4139.668 MiB    1.531 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 4139.668 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 3515583381.25, memory usage is 14062333525.0
--- the wantmem variable after REDUCE is 3515583381.25, memory usage is 14062333525.0
--- the wantmem variable after REDUCE in Mib is 14745.4254383104
--- The memory is being used per voxel is 20575.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 1093547200
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 54677360
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 1096964535
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 800.6930718421936
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  288.879 MiB  157.609 MiB           self.parse_arguments()        
   382  288.887 MiB    0.008 MiB           medium = self.get_medium()
   383  730.012 MiB  441.125 MiB           rte_solver = self.get_solver(medium)
   384 13631.035 MiB 12901.023 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 13632.445 MiB    1.410 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 13632.445 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.3
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 13412185541.25, memory usage is 53648742165.0
--- the wantmem variable after REDUCE is 13412185541.25, memory usage is 53648742165.0
--- the wantmem variable after REDUCE in Mib is 56254.78346440703
--- The memory is being used per voxel is 78495.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 4374188800
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 109354720
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 4377606135
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2591.8565821647644
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.258 MiB  157.988 MiB           self.parse_arguments()        
   382  289.258 MiB    0.000 MiB           medium = self.get_medium()
   383  728.820 MiB  439.562 MiB           rte_solver = self.get_solver(medium)
   384 51382.750 MiB 50653.930 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 51385.645 MiB    2.895 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 51385.645 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 87774249.47500001, memory usage is 351096997.90000004
--- the wantmem variable after REDUCE is 87774249.47500001, memory usage is 351096997.90000004
--- the wantmem variable after REDUCE in Mib is 368.1518856699904
--- The memory is being used per voxel is 513.7
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 15036260
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 3007252
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 15788073
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 128.3784670829773
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.277 MiB  131.277 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.602 MiB  158.324 MiB           self.parse_arguments()        
   382  289.609 MiB    0.008 MiB           medium = self.get_medium()
   383  359.980 MiB   70.371 MiB           rte_solver = self.get_solver(medium)
   384  577.875 MiB  217.895 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  579.977 MiB    2.102 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  579.977 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells=  774600  Npnts=  751810
    15  -2.443  0.333E-01   751810     2.18  0.137   [Radiance 0.672 micron]
    16  -2.613  0.333E-01   751810     2.18  0.137   [Radiance 0.672 micron]
    17  -2.708  0.333E-01   751810     2.18  0.137   [Radiance 0.672 micron]
    18  -2.770  0.333E-01   751810     2.18  0.136   [Radiance 0.672 micron]
    19  -3.355  0.332E-01   751810     2.18  0.136   [Radiance 0.672 micron]
    20  -3.730  0.332E-01   751810     2.18  0.136   [Radiance 0.672 micron]
    21  -4.084  0.332E-01   751810     2.18  0.136   [Radiance 0.672 micron]
 ! Iterations:     21     Final Criterion:  0.000082   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 226107970.27500004, memory usage is 904431881.1000001
--- the wantmem variable after REDUCE is 226107970.27500004, memory usage is 904431881.1000001
--- the wantmem variable after REDUCE in Mib is 948.3655641563137
--- The memory is being used per voxel is 1323.3000000000002
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 60145040
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 6014504
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 60896853
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 179.0257601737976
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.465 MiB  158.191 MiB           self.parse_arguments()        
   382  289.473 MiB    0.008 MiB           medium = self.get_medium()
   383  359.371 MiB   69.898 MiB           rte_solver = self.get_solver(medium)
   384 1105.223 MiB  745.852 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1107.652 MiB    2.430 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1107.652 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells=  773888  Npnts=  751811
    14  -2.303  0.475E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    15  -2.394  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    16  -2.466  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    17  -2.833  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    18  -2.908  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    19  -3.171  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    20  -3.371  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    21  -3.498  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    22  -3.556  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    23  -3.829  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
    24  -4.160  0.453E-01   751811     6.85  0.107   [Radiance 0.672 micron]
 ! Iterations:     24     Final Criterion:  0.000069   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 773428343.8750001, memory usage is 3093713375.5000005
--- the wantmem variable after REDUCE is 773428343.8750001, memory usage is 3093713375.5000005
--- the wantmem variable after REDUCE in Mib is 3243.993596428288
--- The memory is being used per voxel is 4526.500000000001
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 240580160
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 12029008
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 241331973
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 630.6691203117371
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.199 MiB  159.934 MiB           self.parse_arguments()        
   382  291.207 MiB    0.008 MiB           medium = self.get_medium()
   383  362.434 MiB   71.227 MiB           rte_solver = self.get_solver(medium)
   384 3196.160 MiB 2833.727 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 3197.773 MiB    1.613 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 3197.773 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.1
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells=  774022  Npnts=  751810
    14  -2.300  0.500E-01   751810    20.56  0.080   [Radiance 0.672 micron]
    15  -2.378  0.501E-01   751810    20.56  0.080   [Radiance 0.672 micron]
    16  -2.440  0.501E-01   751810    20.56  0.080   [Radiance 0.672 micron]
    17  -2.940  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    18  -3.062  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    19  -3.214  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    20  -3.292  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    21  -3.546  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    22  -3.682  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    23  -3.810  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    24  -3.888  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
    25  -4.088  0.500E-01   751810    20.55  0.080   [Radiance 0.672 micron]
 ! Iterations:     25     Final Criterion:  0.000082   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2950680819.0750003, memory usage is 11802723276.300001
--- the wantmem variable after REDUCE is 2950680819.0750003, memory usage is 11802723276.300001
--- the wantmem variable after REDUCE in Mib is 12376.05236216955
--- The memory is being used per voxel is 17268.9
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 751813
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1127719
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 962320640
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 24058016
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 963072453
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.1
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 1721.656331062317
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.359 MiB  158.090 MiB           self.parse_arguments()        
   382  289.367 MiB    0.008 MiB           medium = self.get_medium()
   383  413.684 MiB  124.316 MiB           rte_solver = self.get_solver(medium)
   384 11521.605 MiB 11107.922 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 11523.500 MiB    1.895 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 11523.500 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 119692158.375, memory usage is 478768633.5
--- the wantmem variable after REDUCE is 119692158.375, memory usage is 478768633.5
--- the wantmem variable after REDUCE in Mib is 502.0252986408959
--- The memory is being used per voxel is 700.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 20504000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 4100800
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 21529200
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 119.54547381401062
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.367 MiB  158.094 MiB           self.parse_arguments()        
   382  289.375 MiB    0.008 MiB           medium = self.get_medium()
   383  439.098 MiB  149.723 MiB           rte_solver = self.get_solver(medium)
   384  709.254 MiB  270.156 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  711.617 MiB    2.363 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  711.617 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 308329050.375, memory usage is 1233316201.5
--- the wantmem variable after REDUCE is 308329050.375, memory usage is 1233316201.5
--- the wantmem variable after REDUCE in Mib is 1293.225769304064
--- The memory is being used per voxel is 1804.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 82016000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 8201600
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 83041200
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 225.66121768951416
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  291.234 MiB  159.961 MiB           self.parse_arguments()        
   382  291.242 MiB    0.008 MiB           medium = self.get_medium()
   383  444.168 MiB  152.926 MiB           rte_solver = self.get_solver(medium)
   384 1420.008 MiB  975.840 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1422.645 MiB    2.637 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1422.645 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells= 1163654  Npnts= 1025197
    23  -2.908  0.110E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.110E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    25  -3.544  0.110E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    26  -3.878  0.109E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
    27  -4.095  0.109E-01  1025197    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000080   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1054675014.375, memory usage is 4218700057.5
--- the wantmem variable after REDUCE is 1054675014.375, memory usage is 4218700057.5
--- the wantmem variable after REDUCE in Mib is 4423.62763149312
--- The memory is being used per voxel is 6172.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 328064000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 16403200
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 329089200
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 852.4403715133667
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.230 MiB  157.965 MiB           self.parse_arguments()        
   382  289.238 MiB    0.008 MiB           medium = self.get_medium()
   383  442.836 MiB  153.598 MiB           rte_solver = self.get_solver(medium)
   384 4268.008 MiB 3825.172 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 4279.555 MiB   11.547 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 4279.531 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 1.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
Further cell splitting requires larger array allocations:  Ncells= 1159338  Npnts= 1025198
    20  -2.611  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    21  -2.694  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    22  -2.782  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    23  -2.988  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    24  -3.041  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    25  -3.313  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    26  -3.659  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    27  -3.871  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    28  -3.956  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
    29  -4.106  0.271E-01  1025198    57.04  0.223   [Radiance 0.672 micron]
 ! Iterations:     29     Final Criterion:  0.000078   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 4023655662.375, memory usage is 16094622649.5
--- the wantmem variable after REDUCE is 4023655662.375, memory usage is 16094622649.5
--- the wantmem variable after REDUCE in Mib is 16876.43503932211
--- The memory is being used per voxel is 23548.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1025200
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 1537800
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 1312256000
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 32806400
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 1313281200
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 1.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2504.032388687134
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.332 MiB  158.059 MiB           self.parse_arguments()        
   382  289.340 MiB    0.008 MiB           medium = self.get_medium()
   383  439.098 MiB  149.758 MiB           rte_solver = self.get_solver(medium)
   384 15589.988 MiB 15150.891 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 15593.461 MiB    3.473 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 15593.461 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 159589544.5, memory usage is 638358178.0
--- the wantmem variable after REDUCE is 159589544.5, memory usage is 638358178.0
--- the wantmem variable after REDUCE in Mib is 669.3670648545279
--- The memory is being used per voxel is 934.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 27338680
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 5467736
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 28705614
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 120.81317925453186
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.227 MiB  157.957 MiB           self.parse_arguments()        
   382  289.227 MiB    0.000 MiB           medium = self.get_medium()
   383  472.980 MiB  183.754 MiB           rte_solver = self.get_solver(medium)
   384  841.609 MiB  368.629 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  844.574 MiB    2.965 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  844.574 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 411105400.5, memory usage is 1644421602.0
--- the wantmem variable after REDUCE is 411105400.5, memory usage is 1644421602.0
--- the wantmem variable after REDUCE in Mib is 1724.3010257387518
--- The memory is being used per voxel is 2406.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 109354720
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 10935472
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 110721654
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 221.07630705833435
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.438 MiB  158.168 MiB           self.parse_arguments()        
   382  289.445 MiB    0.008 MiB           medium = self.get_medium()
   383  474.195 MiB  184.750 MiB           rte_solver = self.get_solver(medium)
   384 1814.633 MiB 1340.438 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1816.273 MiB    1.641 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1816.273 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1406233352.5, memory usage is 5624933410.0
--- the wantmem variable after REDUCE is 1406233352.5, memory usage is 5624933410.0
--- the wantmem variable after REDUCE in Mib is 5898.17017532416
--- The memory is being used per voxel is 8230.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 437418880
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 21870944
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 438785814
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 820.0132939815521
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.137 MiB  157.863 MiB           self.parse_arguments()        
   382  289.145 MiB    0.008 MiB           medium = self.get_medium()
   383  474.035 MiB  184.891 MiB           rte_solver = self.get_solver(medium)
   384 5610.598 MiB 5136.562 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 5612.312 MiB    1.715 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 5612.312 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 5364874216.5, memory usage is 21459496866.0
--- the wantmem variable after REDUCE is 5364874216.5, memory usage is 21459496866.0
--- the wantmem variable after REDUCE in Mib is 22501.91338576281
--- The memory is being used per voxel is 31398.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1366934
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2050401
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 1749675520
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 43741888
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 1751042454
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2765.158994913101
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.336 MiB  158.066 MiB           self.parse_arguments()        
   382  289.344 MiB    0.008 MiB           medium = self.get_medium()
   383  473.254 MiB  183.910 MiB           rte_solver = self.get_solver(medium)
   384 20710.840 MiB 20237.586 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 20713.652 MiB    2.812 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 20713.652 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 199486930.625, memory usage is 797947722.5
--- the wantmem variable after REDUCE is 199486930.625, memory usage is 797947722.5
--- the wantmem variable after REDUCE in Mib is 836.70883106816
--- The memory is being used per voxel is 1167.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 34173340
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 6834668
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 35882007
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 129.628338098526
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.566 MiB  158.293 MiB           self.parse_arguments()        
   382  289.574 MiB    0.008 MiB           medium = self.get_medium()
   383  503.371 MiB  213.797 MiB           rte_solver = self.get_solver(medium)
   384  992.605 MiB  489.234 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385  994.324 MiB    1.719 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387  994.324 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 513881750.625, memory usage is 2055527002.5
--- the wantmem variable after REDUCE is 513881750.625, memory usage is 2055527002.5
--- the wantmem variable after REDUCE in Mib is 2155.37628217344
--- The memory is being used per voxel is 3007.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 136693360
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 13669336
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 138402027
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 217.7174367904663
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.293 MiB  158.027 MiB           self.parse_arguments()        
   382  289.301 MiB    0.008 MiB           medium = self.get_medium()
   383  503.098 MiB  213.797 MiB           rte_solver = self.get_solver(medium)
   384 2198.363 MiB 1695.266 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 2200.141 MiB    1.777 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 2200.141 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1757791690.625, memory usage is 7031166762.5
--- the wantmem variable after REDUCE is 1757791690.625, memory usage is 7031166762.5
--- the wantmem variable after REDUCE in Mib is 7372.7127191552
--- The memory is being used per voxel is 10287.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 546773440
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 27338672
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 548482107
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 605.0420730113983
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.461 MiB  158.191 MiB           self.parse_arguments()        
   382  289.469 MiB    0.008 MiB           medium = self.get_medium()
   383  502.965 MiB  213.496 MiB           rte_solver = self.get_solver(medium)
   384 6944.426 MiB 6441.461 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 6946.129 MiB    1.703 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 6946.129 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 2.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 6706092770.625, memory usage is 26824371082.5
--- the wantmem variable after REDUCE is 6706092770.625, memory usage is 26824371082.5
--- the wantmem variable after REDUCE in Mib is 28127.391732203516
--- The memory is being used per voxel is 39247.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 1708667
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 2563000
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 2187093760
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 54677344
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 2188802427
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 2.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 3341.0618047714233
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.141 MiB  157.867 MiB           self.parse_arguments()        
   382  289.148 MiB    0.008 MiB           medium = self.get_medium()
   383  502.508 MiB  213.359 MiB           rte_solver = self.get_solver(medium)
   384 25820.691 MiB 25318.184 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 25822.898 MiB    2.207 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 25822.898 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 239384316.75, memory usage is 957537267.0
--- the wantmem variable after REDUCE is 239384316.75, memory usage is 957537267.0
--- the wantmem variable after REDUCE in Mib is 1004.0505972817919
--- The memory is being used per voxel is 1401.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 41008020
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 8201604
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 43058421
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 120.76279950141907
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.395 MiB  158.121 MiB           self.parse_arguments()        
   382  289.402 MiB    0.008 MiB           medium = self.get_medium()
   383  551.820 MiB  262.418 MiB           rte_solver = self.get_solver(medium)
   384 1141.586 MiB  589.766 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1143.199 MiB    1.613 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1143.199 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 616658100.75, memory usage is 2466632403.0
--- the wantmem variable after REDUCE is 616658100.75, memory usage is 2466632403.0
--- the wantmem variable after REDUCE in Mib is 2586.451538608128
--- The memory is being used per voxel is 3609.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 164032080
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 16403208
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 166082481
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 251.6588454246521
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.398 MiB  158.125 MiB           self.parse_arguments()        
   382  289.406 MiB    0.008 MiB           medium = self.get_medium()
   383  552.469 MiB  263.062 MiB           rte_solver = self.get_solver(medium)
   384 2582.012 MiB 2029.543 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 2583.613 MiB    1.602 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 2583.613 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2109350028.75, memory usage is 8437400115.0
--- the wantmem variable after REDUCE is 2109350028.75, memory usage is 8437400115.0
--- the wantmem variable after REDUCE in Mib is 8847.25526298624
--- The memory is being used per voxel is 12345.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 656128320
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 32806416
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 658178721
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 813.417980670929
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.312 MiB  158.043 MiB           self.parse_arguments()        
   382  289.320 MiB    0.008 MiB           medium = self.get_medium()
   383  551.867 MiB  262.547 MiB           rte_solver = self.get_solver(medium)
   384 8280.012 MiB 7728.145 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 8286.434 MiB    6.422 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 8286.434 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 8047311324.75, memory usage is 32189245299.0
--- the wantmem variable after REDUCE is 8047311324.75, memory usage is 32189245299.0
--- the wantmem variable after REDUCE in Mib is 33752.87007864422
--- The memory is being used per voxel is 47097.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2050401
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3075601
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 2624513280
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 65612832
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 2626563681
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2641.1908826828003
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  288.988 MiB  157.715 MiB           self.parse_arguments()        
   382  288.996 MiB    0.008 MiB           medium = self.get_medium()
   383  553.207 MiB  264.211 MiB           rte_solver = self.get_solver(medium)
   384 30933.312 MiB 30380.105 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 30935.273 MiB    1.961 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 30935.273 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 279281702.875, memory usage is 1117126811.5
--- the wantmem variable after REDUCE is 279281702.875, memory usage is 1117126811.5
--- the wantmem variable after REDUCE in Mib is 1171.392363495424
--- The memory is being used per voxel is 1634.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 47842680
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 9568536
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 50234814
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 120.32980537414551
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.418 MiB  158.152 MiB           self.parse_arguments()        
   382  289.426 MiB    0.008 MiB           medium = self.get_medium()
   383  591.668 MiB  302.242 MiB           rte_solver = self.get_solver(medium)
   384 1293.676 MiB  702.008 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1295.305 MiB    1.629 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1295.305 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 719434450.875, memory usage is 2877737803.5
--- the wantmem variable after REDUCE is 719434450.875, memory usage is 2877737803.5
--- the wantmem variable after REDUCE in Mib is 3017.5267950428156
--- The memory is being used per voxel is 4210.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 191370720
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 19137072
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 193762854
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 263.5020868778229
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.352 MiB  158.082 MiB           self.parse_arguments()        
   382  289.359 MiB    0.008 MiB           medium = self.get_medium()
   383  591.227 MiB  301.867 MiB           rte_solver = self.get_solver(medium)
   384 2976.754 MiB 2385.527 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 2978.391 MiB    1.637 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 2978.391 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2460908366.875, memory usage is 9843633467.5
--- the wantmem variable after REDUCE is 2460908366.875, memory usage is 9843633467.5
--- the wantmem variable after REDUCE in Mib is 10321.79780681728
--- The memory is being used per voxel is 14402.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 765482880
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 38274144
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 767875014
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 817.7599413394928
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.266 MiB  131.266 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.312 MiB  158.047 MiB           self.parse_arguments()        
   382  289.320 MiB    0.008 MiB           medium = self.get_medium()
   383  591.699 MiB  302.379 MiB           rte_solver = self.get_solver(medium)
   384 9622.145 MiB 9030.445 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 9623.613 MiB    1.469 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 9623.613 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 3.5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 9388529878.875, memory usage is 37554119515.5
--- the wantmem variable after REDUCE is 9388529878.875, memory usage is 37554119515.5
--- the wantmem variable after REDUCE in Mib is 39378.34842508492
--- The memory is being used per voxel is 54946.5
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2392134
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 3588201
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 3061931520
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 76548288
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 3064323654
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 3.5
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 2585.0974123477936
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.277 MiB  131.277 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.359 MiB  158.082 MiB           self.parse_arguments()        
   382  289.367 MiB    0.008 MiB           medium = self.get_medium()
   383  591.133 MiB  301.766 MiB           rte_solver = self.get_solver(medium)
   384 36048.922 MiB 35457.789 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 36050.598 MiB    1.676 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 36050.598 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 319179089.0, memory usage is 1276716356.0
--- the wantmem variable after REDUCE is 319179089.0, memory usage is 1276716356.0
--- the wantmem variable after REDUCE in Mib is 1338.7341297090559
--- The memory is being used per voxel is 1868.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 54677360
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 10935472
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 57411228
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 121.75521516799927
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.277 MiB  131.277 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.570 MiB  158.293 MiB           self.parse_arguments()        
   382  289.578 MiB    0.008 MiB           medium = self.get_medium()
   383  627.625 MiB  338.047 MiB           rte_solver = self.get_solver(medium)
   384 1441.387 MiB  813.762 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1443.207 MiB    1.820 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1443.207 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 822210801.0, memory usage is 3288843204.0
--- the wantmem variable after REDUCE is 822210801.0, memory usage is 3288843204.0
--- the wantmem variable after REDUCE in Mib is 3448.6020514775037
--- The memory is being used per voxel is 4812.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 218709440
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 21870944
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 221443308
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 247.34476470947266
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.211 MiB  157.938 MiB           self.parse_arguments()        
   382  289.211 MiB    0.000 MiB           medium = self.get_medium()
   383  630.590 MiB  341.379 MiB           rte_solver = self.get_solver(medium)
   384 3360.770 MiB 2730.180 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 3362.887 MiB    2.117 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 3362.887 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 2812466705.0, memory usage is 11249866820.0
--- the wantmem variable after REDUCE is 2812466705.0, memory usage is 11249866820.0
--- the wantmem variable after REDUCE in Mib is 11796.34035064832
--- The memory is being used per voxel is 16460.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 874837760
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 43741888
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 877571628
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 605.1304297447205
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.254 MiB  157.980 MiB           self.parse_arguments()        
   382  289.254 MiB    0.000 MiB           medium = self.get_medium()
   383  627.629 MiB  338.375 MiB           rte_solver = self.get_solver(medium)
   384 10956.535 MiB 10328.906 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 10959.062 MiB    2.527 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 10959.062 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 4
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=16, PHI=32
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.624  0.382E+00   683467     6.25  0.024   [Radiance 0.672 micron]
     2  -1.051  0.377E+00   683467     6.32  0.025   [Radiance 0.672 micron]
     3  -1.261  0.331E+00   683488     6.34  0.025   [Radiance 0.672 micron]
     4  -1.367  0.325E+00   683488     6.35  0.025   [Radiance 0.672 micron]
     5  -1.507  0.252E+00   683681     6.41  0.025   [Radiance 0.672 micron]
     6  -1.614  0.168E+00   684631     6.70  0.026   [Radiance 0.672 micron]
     7  -1.682  0.121E+00   686061     7.13  0.028   [Radiance 0.672 micron]
     8  -1.875  0.948E-01   688399     7.71  0.030   [Radiance 0.672 micron]
     9  -1.955  0.666E-01   696218     9.47  0.037   [Radiance 0.672 micron]
    10  -1.997  0.508E-01   706925    11.68  0.046   [Radiance 0.672 micron]
    11  -2.040  0.422E-01   717542    13.82  0.054   [Radiance 0.672 micron]
    12  -2.153  0.365E-01   727897    15.92  0.062   [Radiance 0.672 micron]
    13  -2.204  0.297E-01   746623    19.56  0.076   [Radiance 0.672 micron]
    14  -2.271  0.252E-01   767437    23.41  0.091   [Radiance 0.672 micron]
    15  -2.317  0.214E-01   794462    27.98  0.109   [Radiance 0.672 micron]
    16  -2.388  0.187E-01   824643    32.67  0.128   [Radiance 0.672 micron]
    17  -2.421  0.161E-01   867128    38.76  0.151   [Radiance 0.672 micron]
    18  -2.505  0.143E-01   906879    44.04  0.172   [Radiance 0.672 micron]
    19  -2.544  0.122E-01   971969    51.71  0.202   [Radiance 0.672 micron]
    20  -2.608  0.108E-01  1036383    58.27  0.228   [Radiance 0.672 micron]
    21  -2.658  0.100E-01  1079196    62.26  0.243   [Radiance 0.672 micron]
    22  -2.779  0.100E-01  1080789    62.39  0.244   [Radiance 0.672 micron]
    23  -2.855  0.100E-01  1081023    62.41  0.244   [Radiance 0.672 micron]
    24  -2.907  0.100E-01  1081061    62.41  0.244   [Radiance 0.672 micron]
    25  -3.180  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    26  -3.618  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    27  -3.756  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    28  -3.822  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    29  -3.951  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
    30  -4.150  0.100E-01  1081114    62.41  0.244   [Radiance 0.672 micron]
 ! Iterations:     30     Final Criterion:  0.000071   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 10729748433.0, memory usage is 42918993732.0
--- the wantmem variable after REDUCE is 10729748433.0, memory usage is 42918993732.0
--- the wantmem variable after REDUCE in Mib is 45003.82677152562
--- The memory is being used per voxel is 62796.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 2733868
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 4100802
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 3499351040
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 87483776
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 3502084908
--- NLM    spherical harmonic terms is 256
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 4.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 15
---  mm is 15
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 3712.230236053467
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.438 MiB  158.164 MiB           self.parse_arguments()        
   382  289.445 MiB    0.008 MiB           medium = self.get_medium()
   383  627.652 MiB  338.207 MiB           rte_solver = self.get_solver(medium)
   384 41158.750 MiB 40531.098 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 41161.211 MiB    2.461 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 41161.211 MiB    0.000 MiB           return rte_solver, measurements, medium


without air
--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=2, PHI=4
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.597  0.156E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     2  -0.963  0.144E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     3  -1.169  0.133E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     4  -1.294  0.126E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     5  -1.784  0.113E+00   683467     0.28  0.071   [Radiance 0.672 micron]
     6  -1.908  0.629E-01   684192     0.29  0.072   [Radiance 0.672 micron]
     7  -1.997  0.423E-01   685302     0.29  0.073   [Radiance 0.672 micron]
     8  -2.357  0.321E-01   686923     0.30  0.075   [Radiance 0.672 micron]
     9  -2.262  0.206E-01   694532     0.34  0.085   [Radiance 0.672 micron]
    10  -2.409  0.179E-01   699039     0.36  0.090   [Radiance 0.672 micron]
    11  -2.469  0.147E-01   706908     0.40  0.100   [Radiance 0.672 micron]
    12  -2.515  0.127E-01   713890     0.43  0.108   [Radiance 0.672 micron]
    13  -2.631  0.113E-01   720594     0.46  0.116   [Radiance 0.672 micron]
    14  -2.650  0.100E-01   729540     0.51  0.126   [Radiance 0.672 micron]
    15  -3.133  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    16  -3.655  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    17  -3.958  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
    18  -4.157  0.100E-01   729718     0.51  0.126   [Radiance 0.672 micron]
 ! Iterations:     18     Final Criterion:  0.000070   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 398973861.25, memory usage is 1595895445.0
--- the wantmem variable after REDUCE is 398973861.25, memory usage is 1595895445.0
--- the wantmem variable after REDUCE in Mib is 1673.41766213632
--- The memory is being used per voxel is 2335.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 68346700
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 13669340
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 71764035
--- NLM    spherical harmonic terms is 4
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 1
---  mm is 1
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 118.749844789505
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.270 MiB  131.270 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.445 MiB  158.176 MiB           self.parse_arguments()        
   382  289.453 MiB    0.008 MiB           medium = self.get_medium()
   383  729.180 MiB  439.727 MiB           rte_solver = self.get_solver(medium)
   384 1736.035 MiB 1006.855 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 1737.758 MiB    1.723 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 1737.758 MiB    0.000 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=4, PHI=8
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.603  0.299E+00   683467     0.94  0.059   [Radiance 0.672 micron]
     2  -1.020  0.290E+00   683467     0.95  0.060   [Radiance 0.672 micron]
     3  -1.223  0.272E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     4  -1.325  0.257E+00   683467     0.96  0.060   [Radiance 0.672 micron]
     5  -1.502  0.215E+00   683494     0.95  0.059   [Radiance 0.672 micron]
     6  -1.632  0.144E+00   684058     0.96  0.060   [Radiance 0.672 micron]
     7  -1.776  0.101E+00   685038     0.98  0.061   [Radiance 0.672 micron]
     8  -1.952  0.727E-01   687094     1.02  0.064   [Radiance 0.672 micron]
     9  -2.018  0.507E-01   692823     1.13  0.071   [Radiance 0.672 micron]
    10  -2.067  0.394E-01   700799     1.29  0.080   [Radiance 0.672 micron]
    11  -2.139  0.328E-01   708692     1.43  0.089   [Radiance 0.672 micron]
    12  -2.224  0.277E-01   718232     1.60  0.100   [Radiance 0.672 micron]
    13  -2.274  0.232E-01   730962     1.83  0.114   [Radiance 0.672 micron]
    14  -2.348  0.200E-01   744070     2.05  0.128   [Radiance 0.672 micron]
    15  -2.393  0.172E-01   761858     2.35  0.147   [Radiance 0.672 micron]
    16  -2.458  0.151E-01   781033     2.65  0.166   [Radiance 0.672 micron]
    17  -2.499  0.132E-01   806674     3.03  0.190   [Radiance 0.672 micron]
    18  -2.558  0.118E-01   833898     3.41  0.213   [Radiance 0.672 micron]
    19  -2.592  0.104E-01   869359     3.87  0.242   [Radiance 0.672 micron]
    20  -2.732  0.100E-01   884051     4.05  0.253   [Radiance 0.672 micron]
    21  -2.911  0.100E-01   884724     4.06  0.254   [Radiance 0.672 micron]
    22  -3.004  0.100E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    23  -3.174  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    24  -3.318  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    25  -3.494  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    26  -3.562  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
    27  -4.233  0.101E-01   884807     4.06  0.254   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000058   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 1027763501.25, memory usage is 4111054005.0
--- the wantmem variable after REDUCE is 1027763501.25, memory usage is 4111054005.0
--- the wantmem variable after REDUCE in Mib is 4310.75256434688
--- The memory is being used per voxel is 6015.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 273386800
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 27338680
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 276804135
--- NLM    spherical harmonic terms is 16
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 3
---  mm is 3
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 217.64384937286377
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.273 MiB  131.273 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.219 MiB  157.945 MiB           self.parse_arguments()        
   382  289.227 MiB    0.008 MiB           medium = self.get_medium()
   383  729.184 MiB  439.957 MiB           rte_solver = self.get_solver(medium)
   384 4138.777 MiB 3409.594 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 4140.652 MiB    1.875 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 4140.727 MiB    0.074 MiB           return rte_solver, measurements, medium


--101x101x67--
njobs = 72
max_total_mb = 320000.0
adapt_grid_factor = 5
del_source = False
high_order_radiance = True
num_sh_term_factor = 0.5
MU=8, PHI=16
--------------------
--------------------
0
--------------------
--------------------
2. Render a Tamar's atmosphere, 672nm
  ! Iter Log(Sol)  SplitCrit  Npoints  Nsh(avg)   [Radiance 0.672 micron]
     1  -0.619  0.364E+00   683467     2.40  0.038   [Radiance 0.672 micron]
     2  -1.045  0.358E+00   683467     2.45  0.038   [Radiance 0.672 micron]
     3  -1.252  0.331E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     4  -1.357  0.322E+00   683475     2.47  0.039   [Radiance 0.672 micron]
     5  -1.500  0.245E+00   683630     2.48  0.039   [Radiance 0.672 micron]
     6  -1.611  0.165E+00   684438     2.55  0.040   [Radiance 0.672 micron]
     7  -1.703  0.118E+00   685653     2.64  0.041   [Radiance 0.672 micron]
     8  -1.884  0.903E-01   687902     2.81  0.044   [Radiance 0.672 micron]
     9  -1.966  0.636E-01   694928     3.30  0.052   [Radiance 0.672 micron]
    10  -2.010  0.485E-01   704917     3.96  0.062   [Radiance 0.672 micron]
    11  -2.049  0.403E-01   714710     4.59  0.072   [Radiance 0.672 micron]
    12  -2.170  0.350E-01   723916     5.17  0.081   [Radiance 0.672 micron]
    13  -2.218  0.283E-01   741680     6.25  0.098   [Radiance 0.672 micron]
    14  -2.286  0.241E-01   760099     7.33  0.114   [Radiance 0.672 micron]
    15  -2.338  0.205E-01   784710     8.67  0.135   [Radiance 0.672 micron]
    16  -2.400  0.178E-01   813399    10.12  0.158   [Radiance 0.672 micron]
    17  -2.441  0.154E-01   849984    11.85  0.185   [Radiance 0.672 micron]
    18  -2.517  0.137E-01   888119    13.51  0.211   [Radiance 0.672 micron]
    19  -2.563  0.118E-01   945331    15.77  0.246   [Radiance 0.672 micron]
    20  -2.623  0.104E-01  1005447    17.83  0.279   [Radiance 0.672 micron]
    21  -2.709  0.100E-01  1024260    18.44  0.288   [Radiance 0.672 micron]
    22  -2.818  0.100E-01  1025153    18.47  0.289   [Radiance 0.672 micron]
    23  -2.908  0.100E-01  1025295    18.47  0.289   [Radiance 0.672 micron]
    24  -2.966  0.100E-01  1025336    18.47  0.289   [Radiance 0.672 micron]
    25  -3.303  0.100E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    26  -3.918  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
    27  -4.230  0.101E-01  1025375    18.47  0.289   [Radiance 0.672 micron]
 ! Iterations:     27     Final Criterion:  0.000059   [Radiance 0.672 micron]
Reading mie table from file: ../mie_tables/polydisperse/Water_672nm.scat
-- Ignore high_order_radiance = True
--- the wantmem variable before REDUCE is 3515583381.25, memory usage is 14062333525.0
--- the wantmem variable after REDUCE is 3515583381.25, memory usage is 14062333525.0
--- the wantmem variable after REDUCE in Mib is 14745.4254383104
--- The memory is being used per voxel is 20575.0
---  SYSTEM MAX SIZE is 9223372036854775807
--- MAXIG	max number of internal grid points is 3417335
--- MAXIC	max number of grid cells, between 1 and 2 times grid points is 5126002
--- MAXIV	max words for source function and radiance arrays; needed size is average spherical harmonic truncation times number of grid points is 1093547200
--- MAXIDO	max words for temporary discrete ordinate azimuthal array; needed size is max azimuths times number of grid points. is 54677360
--- MAXIR	The RADIANCE defined by RADIANCE(MAXIV+MAXIG). MAXIR is 1096964535
--- NLM    spherical harmonic terms is 64
--- ADAPTIVE GRID FACTOR    ratio of the max number of internal grid points to the number of base grid points is 5.0
---  CELL_TO_POINT_RATIO is 1.5
---  ml is 7
---  mm is 7
---  nbpts is 683467
[RTE+RENDER]
Elapsed: 622.6680598258972
Finished to render all
Filename: ../render_prespective_view.py

Line #    Mem usage    Increment   Line Contents
================================================
   378  131.277 MiB  131.277 MiB       @profile
   379                                 def SolveAndRender(self):
   380                                     
   381  289.059 MiB  157.781 MiB           self.parse_arguments()        
   382  289.059 MiB    0.000 MiB           medium = self.get_medium()
   383  721.117 MiB  432.059 MiB           rte_solver = self.get_solver(medium)
   384 13629.930 MiB 12908.812 MiB           rte_solver.solve(maxiter=100,init_solution=False, verbose=True)
   385 13631.773 MiB    1.844 MiB           measurements = self.render(medium.get_scatterer('cloud').bounding_box, rte_solver)
   386                                     # bring it back to main.
   387 13631.773 MiB    0.000 MiB           return rte_solver, measurements, medium


